/*! For license information please see 29.bundle.cae61233e0f57b503a54.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{1196:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=f(o(45)),n=f(o(46)),i=f(o(47)),r=f(o(48)),s=f(o(49)),l=o(17),u=f(l),c=f(o(128)),d=o(213);function f(t){return t&&t.__esModule?t:{default:t}}var p=function(t){function e(t){(0,n.default)(this,e);var o=(0,r.default)(this,(e.__proto__||(0,a.default)(e)).call(this,t));return o.clickButton=o.clickButton.bind(o),o.submitCallback=o.submitCallback.bind(o),o}return(0,s.default)(e,t),(0,i.default)(e,[{key:"clickButton",value:function(t){this.props.form.props.component.renderAsForm?this.props.form.activeButton=this:this.submitCallback(this.props.form,t)}},{key:"submitCallback",value:function(t,e){e.preventDefault(),e.stopPropagation();var o=this.props.form.props.component.data;this.geopickerFieldExists()&&(o=this.setGeoData(o)),o&&this.validateData(o)&&this.submitData(o)}},{key:"submitData",value:function(t){var e=this;this.props.form.setLoading(!0),jQuery.post(this.props.button.url,t).done((function(t){if(e.props.form.setLoading(!1),e.props.button.redirectUrl)if(t.success){var o=e.props.button.redirectUrl;e.props.button.redirectUrl.endsWith("/")&&t.alias&&(o+=t.alias),e.props.form.storePosition(),window.location=o}else e.props.form.setErrorTexts(t.fields)}))}},{key:"setGeoData",value:function(t){var e=this.props.form.mapControllerRef,o=e.mapsControls.controls.geopicker,a=e.mapsControls.controls.editor;if(o&&o.$fieldGeoX&&o.$fieldGeoY){var n=o.$fieldGeoX.val(),i=o.$fieldGeoY.val();if(t.geox=n,t.geoy=i,!t.geox&&!t.geoy&&t.locationCity&&t.locationStreet)return this.addPosition(t,e),!1;if(t.geox&&t.geoy&&(!t.locationCity||!t.locationStreet||!t.locationStreetNumber))return this.addAddress(t,e),!1}else if(a&&e.data.editor&&e.data.editor.inputField){var r=$(e.data.editor.inputField).val();t.geojson=r}return t}},{key:"validateData",value:function(t){if(t.published){var e=this.props.form.props.component.fields;for(var o in e)if(e.hasOwnProperty(o)){var a=e[o];if(a.required&&(0,c.default)(a,t)&&!t[a.name]){var n=$("#"+a.name);return n.focus(),n.keyup((function(){$(this).removeClass("field-invalid"),$(this).off("keyup")})),n.addClass("field-invalid"),!1}}if(!this.checkZipcode(t))return!1}return!0}},{key:"checkZipcode",value:function(t){var e=this;try{if(t.geox&&t.geoy&&t.locationZip){var o=this.props.form.mapControllerRef,a=o.data.geosearch.url+"reverse.php?key=";return a+=o.data.geosearch.reverseKey,a+="&lon="+t.geox,a+="&lat="+t.geoy,a+="&format=json",jQuery.ajax({dataType:"json",url:a}).done((function(o){if(o&&o.address&&o.address.postcode)if(o.address.postcode===t.locationZip)e.submitData(t);else{var a=$("#locationZip");a.focus(),a.keyup((function(){$(this).removeClass("field-invalid"),$(this).off("keyup")})),a.addClass("field-invalid");var n=new d.AlertHandler,i=e.props.languageRefs.CHECK_POSITION,r=e.props.languageRefs.POSITION_OUT_OF_RANGE;n.showErrorDialog(i,r)}else e.submitData(t)})).fail((function(){e.submitData(t)})),!1}return!0}catch(t){return!0}}},{key:"addPosition",value:function(t,e){var o=this,a=t.locationCity,n=t.locationStreet,i=t.locationStreetNumber,r=e.data.geosearch.url+"search.php?format=json&limit=1",s=e.data.geosearch.searchKey;r+=a?"&city="+encodeURIComponent(a):"",r+=n?"&street="+encodeURIComponent(i+" "+n):"",r+="&key="+s,jQuery.ajax({dataType:"json",url:r}).done((function(e){if(e[0]&&e[0].lon&&e[0].lat){var a=e[0],n=new d.AlertHandler,i="<b>Breite:</b> "+a.lat+" <br><b>Länge:</b> "+a.lon,r=o.props.languageRefs.ADD_GEOLOCATION,s=o.props.languageRefs.SAVE_WITH_POSITION,l=o.props.languageRefs.SAVE_WITHOUT_POSITION;n.showConfirmDialogHTML(r,i,(function(){var t=o.props.form.props.component.data;t.geoy=a.lat,t.geox=a.lon,o.validateData(t)&&o.submitData(t)}),(function(){var t=o.props.form.props.component.data;o.validateData(t)&&o.submitData(t)}),s,l)}else o.validateData(t)&&o.submitData(t)})).fail((function(){o.validateData(t)&&o.submitData(t)}))}},{key:"addAddress",value:function(t,e){var o=this,a=e.data.geosearch.url+"reverse.php?key=";a+=e.data.geosearch.reverseKey,a+="&lon="+t.geox,a+="&lat="+t.geoy,a+="&format=json",jQuery.ajax({dataType:"json",url:a}).done((function(e){var a=new d.AlertHandler,n=t.locationCity,i=t.locationStreet,r=t.locationStreetNumber,s="";n||(s+="<b>Ort:</b> "+(n=e.address.city||e.address.town||e.address.village)+"<br>"),i||(s+="<b>Straße:</b> "+(i=e.address.road||e.address.street)+"<br>"),r||(s+="<b>Hausnummer:</b> "+(r=e.address.house_number)+"<br>");var l=o.props.languageRefs.ADD_ADDRESS,u=o.props.languageRefs.SAVE_WITH_ADDRESS,c=o.props.languageRefs.SAVE_WITHOUT_ADDRESS;s?a.showConfirmDialogHTML(l,s,(function(){var t=o.props.form.props.component.data;t.locationCity=n,t.locationStreet=i,t.locationStreetNumber=r,o.validateData(t)&&o.submitData(t)}),(function(){var t=o.props.form.props.component.data;o.validateData(t)&&o.submitData(t)}),u,c):o.validateData(t)&&o.submitData(t)})).fail((function(){o.validateData(t)&&o.submitData(t)}))}},{key:"render",value:function(){return u.default.createElement("button",{className:this.props.button.className+" btn btn-primary mr-3",type:"submit",onClick:this.clickButton},this.props.button.caption)}},{key:"geopickerFieldExists",value:function(){for(var t=this.props.form.props.component.fields,e=0;e<t.length;e++)if("geopicker"===t[e].type)return!0;return!1}}]),e}(l.Component);e.default=p},128:function(t,e,o){"use strict";function a(t){return!!(t.conditionField&&t.conditionValue&&"function"==typeof t.conditionField.forEach&&"function"==typeof t.conditionValue.forEach&&t.conditionField.length>0&&t.conditionField.length===t.conditionValue.length)}function n(t,e){var o=!0;return t.conditionField.forEach((function(a,n){void 0===e[a]?o=!1:null===e[a]||e[a].value||String(e[a])===String(t.conditionValue[n])?(e[a]&&e[a].value&&String(e[a].value)!==String(t.conditionValue[n])||null===e[a]&&null!==t.conditionValue[n])&&(o=!1):o=!1}),this),o}Object.defineProperty(e,"__esModule",{value:!0}),e.hasConditions=a,e.checkConditions=n,e.default=function(t,e){return!a(t)||n(t,e)}},213:function(t,e,o){"use strict";o.r(e),o.d(e,"AlertHandler",(function(){return i}));var a=o(342),n=o.n(a);class i{showErrorDialog(t,e,o){n.a.fire({title:t,text:e,type:"error",customClass:o||""})}showInfoDialog(t,e,o){n.a.fire({title:t,text:e,type:"info",customClass:o||""})}showInfoActionDialog(t,e,o,a){n.a.fire({title:t,text:e,type:"info",customClass:a||""}).then((function(){o()}))}showInfoActionDialog2(t,e,o,a){n.a.fire({title:t,text:e,type:"info",showLoaderOnConfirm:!0,customClass:a||"",preConfirm:t=>{o()}})}showConfirmDialog(t,e,o,a,i,r,s){n.a.fire({title:t,text:e,type:"warning",showCancelButton:!0,confirmButtonText:i||"Confirm",cancelButtonText:r||"Cancel",dangerMode:!0,customClass:s||""}).then((t=>{t.value?o():a()}))}showConfirmDialogHTML(t,e,o,a,i,r,s){n.a.fire({title:t,html:e,type:"warning",showCancelButton:!0,confirmButtonText:i||"Confirm",cancelButtonText:r||"Cancel",dangerMode:!0,customClass:s||""}).then((t=>{t.value?o():a()}))}showPreConfirmDialog(t,e,o,a,i,r,s){n.a.fire({title:t,text:e,type:"warning",showCancelButton:!0,confirmButtonText:a||"Confirm",cancelButtonText:i||"Cancel",showLoaderOnConfirm:s||!0,preConfirm:function(){return new Promise((function(t){o()}))},allowOutsideClick:()=>!n.a.isLoading(),dangerMode:!0,customClass:r||""})}showLoadingDialog(t,e,o,a){n.a.fire({title:t,text:e,showCancelButton:!1,allowEscapeKey:!1,allowOutsideClick:!1,showLoaderOnConfirm:!0,onBeforeOpen:()=>{n.a.clickConfirm()},customClass:a||"",preConfirm:()=>new Promise((function(t){o()}))})}async showSelectDialog(t,e,o,a,i){const{value:r}=await n.a.fire({title:t,input:"select",inputOptions:e,inputPlaceholder:"Select a fruit",showCancelButton:!0,confirmButtonText:o,cancelButtonText:a,customClass:i||""});return r}}}}]);