/*! For license information please see 90.bundle.567a56615a6e41645413.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{1553:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(l(45)),o=u(l(46)),a=u(l(47)),s=u(l(48)),i=u(l(49)),r=l(17),d=u(r);function u(e){return e&&e.__esModule?e:{default:e}}var c=d.default.lazy((function(){return l.e(4).then(l.t.bind(null,590,7))})),f=d.default.lazy((function(){return l.e(6).then(l.t.bind(null,591,7))})),m=d.default.lazy((function(){return l.e(5).then(l.t.bind(null,639,7))})),p=d.default.lazy((function(){return l.e(1).then(l.t.bind(null,244,7))})),h=d.default.lazy((function(){return l.e(15).then(l.t.bind(null,800,7))})),b=function(e){function t(e){(0,o.default)(this,t);var l=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return l.renderDefaultContent=l.renderDefaultContent.bind(l),l.openModal=l.openModal.bind(l),l.closeModal=l.closeModal.bind(l),l.closeAndClearModal=l.closeAndClearModal.bind(l),l.onAjaxDone=l.onAjaxDone.bind(l),l.onAjaxFail=l.onAjaxFail.bind(l),l.showForm=l.showForm.bind(l),l.submitForm=l.submitForm.bind(l),l.onFormSubmitDone=l.onFormSubmitDone.bind(l),l.onFormSubmitFail=l.onFormSubmitFail.bind(l),l.state={showModal:!1,modalContent:l.renderDefaultContent()},l}return(0,i.default)(t,e),(0,a.default)(t,[{key:"renderDefaultContent",value:function(){return d.default.createElement(m,{title:this.props.field.label,onConfirm:this.closeModal,confirmButtonText:this.props.field.closeButtonText},d.default.createElement("div",{style:{textAlign:"center",margin:"auto"}},d.default.createElement("img",{src:"bundles/con4gisframework/img/preloader-image.svg",className:"preloader-image",alt:""})))}},{key:"openModal",value:function(){var e=this.props.field.url;this.props.field.urlField&&(e=e.replace(this.props.field.urlField,this.props.data[this.props.field.urlField])),jQuery.get(e).done(this.onAjaxDone).fail(this.onAjaxFail),this.setState({showModal:!0})}},{key:"closeModal",value:function(){this.setState({showModal:!1})}},{key:"closeAndClearModal",value:function(){this.setState({showModal:!1,modalContent:this.renderDefaultContent()})}},{key:"onAjaxDone",value:function(e){try{this.showForm(e)}catch(e){console.error(e),this.closeModal()}}},{key:"onAjaxFail",value:function(e){var t=e.responseJSON;t.error?this.setState({modalContent:d.default.createElement(f,{title:t.error.title,message:t.error.message,onConfirm:this.closeModal,confirmButtonText:t.error.confirmButtonText})}):this.closeModal()}},{key:"showForm",value:function(e){var t=this;try{var l=void 0;l=void 0!==this.props.field.innerFields&&this.props.field.innerFields.length>0?this.props.fields.filter((function(e){return t.props.field.innerFields.includes(e.name)})):this.props.fields.filter((function(e){return e.type!==t.props.field.type}));var n={updateFunction:function(){}},o=d.default.createElement("div",{className:this.props.className||"c4g-modal-content"},d.default.createElement("button",{className:"c4g-btn c4g-btn-top-close",type:"button",onClick:this.closeModal},d.default.createElement("span",{className:"c4g-btn-text"},this.props.field.closeButtonText)),d.default.createElement("div",{className:"c4g-modal__title-wrapper"},d.default.createElement("span",{className:"c4g-modal__title"},this.props.field.label)),d.default.createElement("form",null,d.default.createElement("div",null,d.default.createElement(r.Suspense,{fallback:d.default.createElement("div",{style:{textAlign:"center",margin:"auto"}},d.default.createElement("img",{src:"bundles/con4gisframework/img/preloader-image.svg",className:"preloader-image",alt:""}))},d.default.createElement(h,{dataEntry:this.props.data,fields:l,list:this.props.list,languageRefs:this.props.languageRefs}),e.formFields.map((function(l,o){return d.default.createElement(p,{form:{props:n,fields:e.formFields},field:l,data:e.formData||[],key:o+1,languageRefs:t.props.languageRefs})})))),d.default.createElement("div",{className:"c4g-panel-buttons"},d.default.createElement("button",{className:"c4g-btn c4g-btn-submit",type:"button",onClick:this.submitForm},d.default.createElement("span",{className:"c4g-btn-text"},this.props.field.confirmButtonText)),d.default.createElement("button",{className:"c4g-btn c4g-btn-close",type:"button",onClick:this.closeModal},d.default.createElement("span",{className:"c4g-btn-text"},this.props.field.closeButtonText)))));this.setState({modalContent:o})}catch(e){console.error(e),this.closeModal()}}},{key:"submitForm",value:function(e){for(var t=e.target.parentNode.form.elements,l={},n=0;n<t.length;){var o=t.item(n);o.name&&(l[o.name]=o.value),n+=1}jQuery.post(this.props.field.submitUrl,l).done(this.onFormSubmitDone).fail(this.onFormSubmitFail)}},{key:"onFormSubmitDone",value:function(e){e&&e.success?this.setState({modalContent:d.default.createElement(f,{title:e.success.title,message:e.success.message,onConfirm:this.closeAndClearModal,confirmButtonText:this.props.field.closeButtonText})}):this.closeModal()}},{key:"onFormSubmitFail",value:function(e){var t=e.responseJSON;t&&t.error?this.setState({modalContent:d.default.createElement(f,{title:t.error.title,message:t.error.message,onConfirm:this.showForm.bind(this,t),confirmButtonText:this.props.field.closeButtonText})}):this.closeModal()}},{key:"render",value:function(){if(!this.props.field.label)return null;if(this.props.field.conditions&&"function"==typeof this.props.field.conditions.forEach){var e=!0;if(this.props.field.conditions.forEach((function(t){var l=this.props.data;t.not?String(l[t.field])===String(t.value)&&(e=!1):String(l[t.field])!==String(t.value)&&(e=!1)}),this),!1===e)return null}return d.default.createElement("div",{className:this.props.field.wrapperClass},d.default.createElement("button",{className:this.props.field.class,onClick:this.openModal},this.props.field.label),d.default.createElement(c,{show:this.state.showModal,onClose:this.closeModal},this.state.modalContent))}}]),t}(r.Component);t.default=b}}]);