/*! For license information please see 2198.bundle.bad53530e8957e72e229.js.LICENSE.txt */
"use strict";(self.webpackChunkframeworkbundle=self.webpackChunkframeworkbundle||[]).push([[2198],{7034:(e,t,a)=>{var r=a(29138),o=a(35578);Object.defineProperty(t,"__esModule",{value:!0}),t.MeasuretoolsView=void 0;var s=r(a(1367)),n=r(a(60163)),u=r(a(55956)),l=r(a(20880)),i=r(a(39959)),c=function(e,t){if("function"==typeof WeakMap)var a=new WeakMap,r=new WeakMap;return function(e,t){if(!t&&e&&e.__esModule)return e;var s,n,u={__proto__:null,default:e};if(null===e||"object"!=o(e)&&"function"!=typeof e)return u;if(s=t?r:a){if(s.has(e))return s.get(e);s.set(e,u)}for(var l in e)"default"!==l&&{}.hasOwnProperty.call(e,l)&&((n=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,l))&&(n.get||n.set)?s(u,l,n):u[l]=e[l]);return u}(e,t)}(a(42028)),d=a(23624),p=a(6859),m=a(7323),f=a(46363),h=a(65030),v=a(59159);function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(g=function(){return!!e})()}t.MeasuretoolsView=function(e){function t(e){var a,r,o,n;(0,s.default)(this,t),r=this,o=t,n=[e],o=(0,l.default)(o),a=(0,u.default)(r,g()?Reflect.construct(o,n||[],(0,l.default)(r).constructor):o.apply(r,n));var i=(0,d.getLanguage)(a.props.mapController.data);return a.headlines={select:i.MEASURETOOLS_VIEW_TRIGGER_SELECT,line:i.MEASURETOOLS_VIEW_TRIGGER_DRAW_LINESTRING,polygon:i.MEASURETOOLS_VIEW_TRIGGER_DRAW_POLYGON,circle:i.MEASURETOOLS_VIEW_TRIGGER_DRAW_CIRCLE,freehand:i.MEASURETOOLS_VIEW_TRIGGER_DRAW_FREEHAND},a.featureIdCtr=a.props.featureId,a.updateFunctions=a.createMeasureFunctions(),a.modifyFeature=a.modifyFeature.bind(a),a}return(0,i.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this;return this.props.active?"select"===this.props.mode?c.default.createElement("div",{className:"c4g-measuretools-content"},c.default.createElement("p",null,this.props.lang.MEASURETOOLS_INFO),c.default.createElement("br",null),c.default.createElement("br",null),c.default.createElement("sub",null,this.props.lang.MEASURETOOLS_INFO_ADDITIONAL)):c.default.createElement("div",{className:"c4g-measuretools-content"},c.default.createElement("div",{className:"contentHeadline"},this.headlines[this.props.mode]),c.default.createElement("div",null,Object.keys(this.props.features).map(function(t,a){var r=e.props.features[t];return c.default.createElement(v.MeasuredFeature,{key:a,idx:a,label:r.label,feature:r,measuredValues:r.measuredValues,modifyFeature:e.modifyFeature})}))):null}},{key:"modifyFeature",value:function(e,t){for(var a=this.props.features,r=0;r<a.length;r++)if(a[r].id===t){a[r].olFeature.set("featureLabel",e.label),this.updateMeasureFeature(a[r].olFeature);break}this.props.modifyFeature(e,t)}},{key:"componentDidMount",value:function(){"select"!==this.props.mode&&this.updateFunctions.initFunction()}},{key:"componentDidUpdate",value:function(e,t,a){"select"!==this.props.mode&&(!e.active&&this.props.active&&this.updateFunctions.activateFunction(),e.active&&!this.props.active&&this.updateFunctions.deactivateFunction(),this.props.mapController.mapHover.deactivate()),"select"!==this.props.mode&&this.props.measureTools.state.open||this.props.mapController.mapHover.activate(),this.featureIdCtr=this.props.featureId}},{key:"createMeasureFunctions",value:function(){var e,t,a,r,o=this;return{initFunction:function(){var s,n,u,l,i,c,d,v;if(s=o.featureIdCtr,e="freehand"===o.props.mode.toLowerCase()?o.props.measureTools.measureFreehandLayer.getSource():"circle"===o.props.mode.toLowerCase()?o.props.measureTools.measureCircleLayer.getSource():"polygon"===o.props.mode.toLowerCase()?o.props.measureTools.measurePolygonLayer.getSource():o.props.measureTools.measureLineLayer.getSource(),t=new p.Collection,"select"!==o.props.mode.toLowerCase()){switch(o.props.mode){case"line":case"freehand":a="LineString";break;case"polygon":a="Polygon";break;case"circle":a="Circle"}return r=new m.Draw({features:t,source:e,type:a,freehand:"freehand"===o.props.mode}),l=function(e){var t,a,r,n;if(!e)return!1;"LineString"===e.getGeometry().getType()?(o.props.lang.LENGTH,t=o.props.lang.LINE,a=!1,r=!1,n=!0):"Polygon"===e.getGeometry().getType()?(o.props.lang.PERIMETER,t=o.props.lang.POLYGON,a=!0,r=!1,n=!1):"Circle"===e.getGeometry().getType()?(o.props.lang.RADIUS,t=o.props.lang.CIRCLE,a=!0,r=!0,n=!1):(o.props.lang.LENGTH,t=o.props.lang.FREEHAND,a=!1,r=!1,n=!0),s=o.featureIdCtr,e.set("featureId",s);var u={};u.id=s,u.label=t+" "+s,e.set("featureLabel",u.label),u.measuredValues={},n&&(u.measuredValues.line={description:"Länge: ",value:0}),r&&(u.measuredValues.radius={description:"Radius: ",value:0}),a&&(u.measuredValues.area={description:"Flächeninhalt: ",value:0}),u.olFeature=e,o.props.addFeature(u),o.props.incrFeatId()},i=function(e){var t,a,r,s,n;t=e.get("tooltip"),a=e.get("featureLabel"),r=f.utils.measureGeometry(e.getGeometry(),!0),e.set("measuredLength",r.rawValue),t.setContent("<strong>"+a+"</strong><br>"+r.htmlValue);var u=e.get("featureId"),l={};l.label=a,l.id=u,l.measuredValues={},l.olFeature=e,r&&"circle"!==e.get("geometryType")&&"polygon"!==e.get("geometryType")&&(l.measuredValues.line={},l.measuredValues.line.description="Länge: ",l.measuredValues.line.value=r.rawValue),"circle"===e.get("geometryType")&&(n=f.utils.measureGeometry(e.getGeometry()),l.measuredValues.radius={description:"Radius: ",value:0},l.measuredValues.radius.value=n.rawValue,t.setContent("<strong>"+a+"</strong><br>"+l.measuredValues.radius.description+n.htmlValue)),"polygon"!==e.get("geometryType")&&"circle"!==e.get("geometryType")||(s=f.utils.measureGeometry(e.getGeometry(),!1,!0),l.measuredValues.area={description:"Flächeninhalt: ",value:0},l.measuredValues.area.value=s.rawValue,t.setContent("<strong>"+a+"</strong><br>"+l.measuredValues.area.description+s.htmlValue)),e.set("tooltip",t),o.props.modifyFeature(l,l.id)},o.updateMeasureFeature=i,v=function(e){o.props.removeFeature(e.get("featureId"))},c=function(e){var t=f.utils.measureGeometry(e.getGeometry(),!0).htmlValue.match(/\d/g);return t=t.join("")},d=function(){var e="0.00 m".match(/\d/g);return e=e.join(""),e=8},r.on("drawstart",function(t){n=t.feature,u=new h.TooltipPopUp({map:o.props.mapController.map,position:t.coordinate,offset:[2,-2],horizontal:!0,closeable:!0,closeFunction:function(){var a=c(t.feature),r=d();a!==r&&a>r?(v(t.feature),e.hasFeature(t.feature)&&e.removeFeature(t.feature)):v(t.feature)}}),n.set("tooltip",u),n.set("geometryType",o.props.mode.toLowerCase()),l(n)},o),o.props.mapController.map.on("pointermove",function(e){n&&u&&(u.setPosition(e.coordinate),i(n))},o),r.on("drawend",function(e){n&&u&&(i(n),n=null,u=null)},o),!0}},activateFunction:function(){t.clear(),o.props.mapController.map.addInteraction(r)},deactivateFunction:function(){if("point"!==o.props.mode.toLowerCase())try{r.finishDrawing()}catch(e){}o.props.mapController.map.removeInteraction(r)}}}}])}(c.Component)},22198:(e,t,a)=>{var r=a(29138),o=a(35578);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=r(a(1367)),n=r(a(60163)),u=r(a(55956)),l=r(a(20880)),i=r(a(39959)),c=function(e,t){if("function"==typeof WeakMap)var a=new WeakMap,r=new WeakMap;return function(e,t){if(!t&&e&&e.__esModule)return e;var s,n,u={__proto__:null,default:e};if(null===e||"object"!=o(e)&&"function"!=typeof e)return u;if(s=t?r:a){if(s.has(e))return s.get(e);s.set(e,u)}for(var l in e)"default"!==l&&{}.hasOwnProperty.call(e,l)&&((n=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,l))&&(n.get||n.set)?s(u,l,n):u[l]=e[l]);return u}(e,t)}(a(42028)),d=a(23624),p=a(13161),m=a(7034),f=a(58707),h=a(12556),v=a(6859),g=a(46363);function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(y=function(){return!!e})()}var F=c.default.lazy(function(){return Promise.resolve().then(a.bind(a,47702))});t.default=function(e){function t(e){var a,r,o,n;(0,s.default)(this,t),r=this,o=t,n=[e],o=(0,l.default)(o);var i=a=(0,u.default)(r,y()?Reflect.construct(o,n||[],(0,l.default)(r).constructor):o.apply(r,n)),c=document.createElement("div"),m=document.createElement("button");if(a.langConstants=(0,d.getLanguage)(e.mapController.data),e.mapController.data.themeData&&e.mapController.data.themeData.controlLabels){var f=document.createElement("span");f.innerText=a.langConstants.CTRL_MEASURETOOLS,m.appendChild(f)}else m.title=a.langConstants.CTRL_MEASURETOOLS;c.className="c4g-measuretools-control ol-unselectable ol-control ",e.open?c.className+="c4g-open":c.className+="c4g-close",e.external&&(c.className+=" c4g-external"),c.appendChild(m),jQuery(c).on("click",function(e){var t=i.props.mapController.measuretoolsContainer.className.includes("c4g-close");i.state.open?t?jQuery(i.props.mapController.measuretoolsContainer).removeClass("c4g-close").addClass("c4g-open"):i.close():i.open()});var h=e.mapController,v=new p.Control({element:c,target:e.target}),g=h.arrComponents.findIndex(function(e){return"measuretools"===e.name});return h.arrComponents[g].control=v,h.mapsControls.controls.measuretools=v,a.close=a.close.bind(a),a.open=a.open.bind(a),a.addMeasuredFeature=a.addMeasuredFeature.bind(a),a.modifyMeasuredFeature=a.modifyMeasuredFeature.bind(a),a.removeMeasuredFeature=a.removeMeasuredFeature.bind(a),a.incrementFeatureId=a.incrementFeatureId.bind(a),a.modes=["select","line","polygon","circle","freehand"],a.state={open:e.open||!1,currentMode:"select",control:v,measuredFeatures:[],featureIdCtr:0},a.init(),a}return(0,i.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this,t={select:this.langConstants.MEASURETOOLS_VIEW_TRIGGER_SELECT,line:this.langConstants.MEASURETOOLS_VIEW_TRIGGER_DRAW_LINESTRING,polygon:this.langConstants.MEASURETOOLS_VIEW_TRIGGER_DRAW_POLYGON,circle:this.langConstants.MEASURETOOLS_VIEW_TRIGGER_DRAW_CIRCLE,freehand:this.langConstants.MEASURETOOLS_VIEW_TRIGGER_DRAW_FREEHAND};return c.default.createElement("div",{className:"c4g-measuretools-wrapper"},c.default.createElement(c.Suspense,{fallback:c.default.createElement("div",null,"Loading...")},c.default.createElement(F,{wrapperClass:"c4g-measuretools-header",headerClass:"c4g-measuretools-headline",hideContainer:".c4g-measuretools-container",header:this.langConstants.MEASURETOOLS,closeBtnClass:"c4g-titlebar-close",closeBtnCb:this.close,closeBtnTitle:this.langConstants.CLOSE})),c.default.createElement("div",{className:"c4g-measuretools-mode-switcher"},this.modes.map(function(a,r){return c.default.createElement("button",{key:r,className:"c4g-measure-"+a+" "+(a===e.state.currentMode?"c4g-active":"c4g-inactive"),onMouseUp:function(){return e.setState({currentMode:a})},title:t[a]})})),c.default.createElement(m.MeasuretoolsView,{mode:"select",measureTools:this,active:"select"===this.state.currentMode&&this.state.open,featureId:this.state.featureIdCtr,lang:this.langConstants,addFeature:this.addMeasuredFeature,features:this.state.measuredFeatures,incrFeatId:this.incrementFeatureId,modifyFeature:this.modifyMeasuredFeature,mapController:this.props.mapController,removeFeature:this.removeMeasuredFeature}),c.default.createElement(m.MeasuretoolsView,{mode:"line",measureTools:this,active:"line"===this.state.currentMode&&this.state.open,featureId:this.state.featureIdCtr,lang:this.langConstants,addFeature:this.addMeasuredFeature,features:this.state.measuredFeatures,incrFeatId:this.incrementFeatureId,modifyFeature:this.modifyMeasuredFeature,mapController:this.props.mapController,removeFeature:this.removeMeasuredFeature}),c.default.createElement(m.MeasuretoolsView,{mode:"polygon",measureTools:this,active:"polygon"===this.state.currentMode&&this.state.open,featureId:this.state.featureIdCtr,lang:this.langConstants,addFeature:this.addMeasuredFeature,features:this.state.measuredFeatures,incrFeatId:this.incrementFeatureId,modifyFeature:this.modifyMeasuredFeature,mapController:this.props.mapController,removeFeature:this.removeMeasuredFeature}),c.default.createElement(m.MeasuretoolsView,{mode:"circle",measureTools:this,active:"circle"===this.state.currentMode&&this.state.open,featureId:this.state.featureIdCtr,lang:this.langConstants,addFeature:this.addMeasuredFeature,features:this.state.measuredFeatures,incrFeatId:this.incrementFeatureId,modifyFeature:this.modifyMeasuredFeature,mapController:this.props.mapController,removeFeature:this.removeMeasuredFeature}),c.default.createElement(m.MeasuretoolsView,{mode:"freehand",measureTools:this,active:"freehand"===this.state.currentMode&&this.state.open,featureId:this.state.featureIdCtr,lang:this.langConstants,addFeature:this.addMeasuredFeature,features:this.state.measuredFeatures,incrFeatId:this.incrementFeatureId,modifyFeature:this.modifyMeasuredFeature,mapController:this.props.mapController,removeFeature:this.removeMeasuredFeature}))}},{key:"incrementFeatureId",value:function(){this.setState({featureIdCtr:this.state.featureIdCtr+1})}},{key:"addMeasuredFeature",value:function(e){var t=this.state.measuredFeatures;t.push(e),this.setState({measuredFeatures:t})}},{key:"modifyMeasuredFeature",value:function(e,t){for(var a=this.state.measuredFeatures,r=0;r<a.length;r++)a[r].id===t&&(a[r]=e);this.setState({measuredFeatures:a})}},{key:"removeMeasuredFeature",value:function(e){for(var t=this.state.measuredFeatures,a=0;a<t.length;a++)if(t[a].id===e){t.splice(a,1);break}this.setState({measuredFeatures:t})}},{key:"setCurrentMode",value:function(e){this.modes.includes(e)?this.setState({currentMode:e}):console.warn("The specified mode is not available")}},{key:"open",value:function(){this.setState({open:!0}),this.props.mapController.setOpenComponent(this)}},{key:"close",value:function(){this.setState({open:!1})}},{key:"init",value:function(){return this.measureLineLayer=new f.Vector({source:new h.Vector}),this.measurePolygonLayer=new f.Vector({source:new h.Vector}),this.measureCircleLayer=new f.Vector({source:new h.Vector}),this.measureFreehandLayer=new f.Vector({source:new h.Vector}),this.measureLayerGroup=new f.Group({layers:new v.Collection([this.measureFreehandLayer,this.measureCircleLayer,this.measurePolygonLayer,this.measureLineLayer]),visible:!0}),this.props.mapController.map.addLayer(this.measureLayerGroup),!0}},{key:"componentDidUpdate",value:function(e,t,a){if(t.open&&!this.state.open)jQuery(this.state.control.element).removeClass("c4g-open").addClass("c4g-close"),jQuery(".c4g-measuretools-container").removeClass("c4g-open").addClass("c4g-close"),this.props.mapController.map.removeLayer(this.measureLayerGroup),this.removeTooltips(),this.removedOnce=!0;else if(!t.open&&this.state.open){if(jQuery(this.state.control.element).addClass("c4g-open").removeClass("c4g-close"),jQuery(".c4g-measuretools-container").addClass("c4g-open").removeClass("c4g-close"),this.removedOnce)try{this.props.mapController.map.addLayer(this.measureLayerGroup)}catch(e){console.warn(e)}this.addTooltips()}if(this.props.mapController.data.caching){var r=g.utils.getValue("panel");"Measuretools"!==r||this.state.open?"Measuretools"!==r&&this.state.open&&g.utils.storeValue("panel","Measuretools"):g.utils.storeValue("panel","")}}},{key:"removeTooltips",value:function(){for(var e=this.measureLayerGroup.getLayersArray(),t=0;t<e.length;t++){var a=e[t].getSource().getFeatures();if(a)for(var r=0;r<a.length;r++){a[r].get("tooltip").hide()}}}},{key:"addTooltips",value:function(){for(var e=this.measureLayerGroup.getLayersArray(),t=0;t<e.length;t++){var a=e[t].getSource().getFeatures();if(a)for(var r=0;r<a.length;r++){a[r].get("tooltip").show()}}}}])}(c.Component)},59159:(e,t,a)=>{var r=a(29138),o=a(35578);Object.defineProperty(t,"__esModule",{value:!0}),t.MeasuredFeature=void 0;var s=r(a(1367)),n=r(a(60163)),u=r(a(55956)),l=r(a(20880)),i=r(a(39959)),c=function(e,t){if("function"==typeof WeakMap)var a=new WeakMap,r=new WeakMap;return function(e,t){if(!t&&e&&e.__esModule)return e;var s,n,u={__proto__:null,default:e};if(null===e||"object"!=o(e)&&"function"!=typeof e)return u;if(s=t?r:a){if(s.has(e))return s.get(e);s.set(e,u)}for(var l in e)"default"!==l&&{}.hasOwnProperty.call(e,l)&&((n=(s=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,l))&&(n.get||n.set)?s(u,l,n):u[l]=e[l]);return u}(e,t)}(a(42028));function d(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(d=function(){return!!e})()}t.MeasuredFeature=function(e){function t(e){var a,r,o,n;return(0,s.default)(this,t),r=this,o=t,n=[e],o=(0,l.default)(o),(a=(0,u.default)(r,d()?Reflect.construct(o,n||[],(0,l.default)(r).constructor):o.apply(r,n))).changeFeatureLabel=a.changeFeatureLabel.bind(a),a}return(0,i.default)(t,e),(0,n.default)(t,[{key:"render",value:function(){var e=this;return c.default.createElement("div",null,c.default.createElement("div",null,c.default.createElement("label",{htmlFor:"measureElement_"+this.props.idx},"Name: "),c.default.createElement("input",{type:"text",name:"measureElement_"+this.props.idx,defaultValue:this.props.label,onInput:this.changeFeatureLabel})),Object.keys(this.props.measuredValues).map(function(t,a){var r=e.props.measuredValues[t],o=0;switch(t){case"line":case"radius":o=e.convertMetersToKm(r.value);break;case"area":o=e.convertSquareMetersToSquareKm(r.value)}return c.default.createElement("p",{key:a},c.default.createElement("strong",null,r.description),c.default.createElement("span",{className:"c4g-measure-value-"+e.props.idx},o))}))}},{key:"changeFeatureLabel",value:function(){var e=this.props.feature;e.label=document.querySelector('input[name="measureElement_'+this.props.idx+'"]').value,this.props.modifyFeature(e,e.id)}},{key:"convertMetersToKm",value:function(e){var t=e/1e3;return t>0?t+" km":e+" m"}},{key:"convertSquareMetersToSquareKm",value:function(e){var t=e/1e6;return t>0?t+" km²":e+" m²"}}])}(c.Component)}}]);