/*! For license information please see 424.bundle.48cbf96e32a2ba8014f3.js.LICENSE.txt */
"use strict";(self.webpackChunkframeworkbundle=self.webpackChunkframeworkbundle||[]).push([[424],{10424(e,t,r){var a=r(29138),n=r(35578);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(r(1367)),s=a(r(60163)),i=a(r(55956)),l=a(r(20880)),c=a(r(39959)),u=function(e,t){if("function"==typeof WeakMap)var r=new WeakMap,a=new WeakMap;return function(e,t){if(!t&&e&&e.__esModule)return e;var o,s,i={__proto__:null,default:e};if(null===e||"object"!=n(e)&&"function"!=typeof e)return i;if(o=t?a:r){if(o.has(e))return o.get(e);o.set(e,i)}for(var l in e)"default"!==l&&{}.hasOwnProperty.call(e,l)&&((s=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,l))&&(s.get||s.set)?o(i,l,s):i[l]=e[l]);return i}(e,t)}(r(42028)),p=(r(58707),r(12556),r(36855)),d=r(6859),f=r(8007),h=r(7323),m=r(46363),y=r(45451);r(15049),r(65030);function v(e,t,r){return t=(0,l.default)(t),(0,i.default)(e,g()?Reflect.construct(t,r||[],(0,l.default)(e).constructor):t.apply(e,r))}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(g=function(){return!!e})()}t.default=function(e){function t(e){var r;(0,o.default)(this,t);r=v(this,t,[e]);return r.state={freehand:!1,selectedFeature:!1,features:"[]",activeElement:e.elements[0]?e.elements[0].id:0,activeStyle:e.elements[0]?e.elements[0].styleId:0,selectMode:"modify"},r.interaction=null,r.changeJSON=r.changeJSON.bind(r),r.resetInteraction=r.resetInteraction.bind(r),r}return(0,c.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this;if("select"!==this.props.mode&&this.props.active){var t;switch(this.resetInteraction(),this.props.mode){case"Point":t=new f.Point(0,0);break;case"LineString":t=new f.LineString([[0,0],[1,1]]);break;case"Polygon":t=new f.Polygon([[0,0],[1,1]])}var r=new d.Feature(t);r.set("locstyle",this.state.activeStyle),this.interaction=new h.Draw({source:this.props.editorLayer.getSource(),type:this.props.mode,snapTolerance:1,style:this.props.styleFunction(r),freehand:this.state.freehand}),this.interaction.on("drawend",function(t){var r;if(t.feature.set("editorId",e.props.editorId),t.feature.set("locstyle",e.state.activeStyle),t.feature.set("elementId",e.state.activeElement),"Circle"===e.props.mode){var a=t.feature.getGeometry().clone().transform("EPSG:3857","EPSG:4326").getCenter(),n=t.feature.getGeometry().getRadius(),o=m.utils.measureGeometry(t.feature.getGeometry()).rawValue;r={type:"Feature",geometry:{type:"Point",coordinates:a},properties:{editorId:e.props.editorId,elementId:e.state.activeElement,locstyle:e.state.activeStyle,radius:n,realRadius:o}}}else r=(new p.GeoJSON).writeFeatureObject(t.feature,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});var s={source:e.props.editorLayer.getSource(),geojson:r,event:t,format:new p.GeoJSON};m.utils.callHookFunctions(window.c4gMapsHooks.hook_editor_draw,s),e.props.addFeature(r),e.props.countEditorId()}),this.props.mapController.map.addInteraction(this.interaction)}else"select"===this.props.mode&&this.props.active?(this.resetInteraction(),this.interaction=[],this.interaction.push(new h.Select({layers:[this.props.editorLayer],hitTolerance:20})),this.interaction.push(new h.Modify({features:this.state.selectedFeature?new d.Collection([this.state.selectedFeature]):new d.Collection([new d.Feature]),pixelTolerance:20})),this.interaction[0].on("select",function(t){var r=t.selected[0];e.setState({selectedFeature:r})}),this.interaction[1].on("modifyend",function(t){var r,a=t.features.getArray()[0];if(a.getGeometry()instanceof f.Circle){var n=a.getGeometry().clone().transform("EPSG:3857","EPSG:4326").getCenter(),o=a.getGeometry().getRadius(),s=m.utils.measureGeometry(a.getGeometry()).rawValue;r={type:"Feature",geometry:{type:"Point",coordinates:n},properties:{editorId:a.get("editorId"),elementId:a.get("elementId"),locstyle:a.get("activeStyle"),radius:o,realRadius:s}}}else r=(new p.GeoJSON).writeFeatureObject(a,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});var i={source:e.props.editorLayer.getSource(),geojson:r,event:t,format:new p.GeoJSON};m.utils.callHookFunctions(window.c4gMapsHooks.hook_editor_modify,i),e.props.modifyFeature(r)}),this.props.mapController.map.addInteraction(this.interaction[0]),this.props.mapController.map.addInteraction(this.interaction[1])):this.resetInteraction();var a=null;this.props.elements&&this.props.elements.length>0&&(a=this.props.elements.map(function(t){var r,a,n=e.props.styleData.arrLocStyles[t.styleId],o=n.locStyleArr,s=o?o.styletype:"default";if(!o||"cust_icon"!==s&&"cust_icon_svg"!==s&&"photo"!==s){var i=n.style&&n.style(new d.Feature({geometry:new f.Point(0,0)}),"EPSG:4326")?n.style(new d.Feature({geometry:new f.Point(0,0)}),"EPSG:4326"):null,l=Array.isArray(i)?i[0]:i;l&&l.getFill()&&l.getStroke()?r=l.getFill().getColor():o&&o.fillcolor&&o.strokecolor&&(r=m.utils.getRgbaFromHexAndOpacity(o.fillcolor[0],o.fillcolor[1])),a=u.default.createElement("span",{title:t.name,className:"c4g-editor-locstyle",style:{backgroundColor:r}})}else a=u.default.createElement(y.C4gStarboardStyle,{tooltip:t.name,styleData:e.props.styleData,styleId:t.styleId});return u.default.createElement("button",{key:t.id,style:{height:"32px",width:"32px"},onMouseUp:function(){e.setState({activeElement:t.id,activeStyle:t.styleId})}},a)}));var n=null;if("LineStringPolygon".includes(this.props.mode)){var o="c4g-editor-view ";o+=this.state.freehand?"c4g-active":"c4g-inactive",n=u.default.createElement("a",{className:o,title:this.props.lang.EDITOR_VIEW_TRIGGER_DRAW_FREEHAND,onMouseUp:function(){e.changeFreehand()}},this.props.lang.EDITOR_VIEW_TRIGGER_DRAW_FREEHAND)}var s=[];if(this.state.selectedFeature&&"select"===this.props.mode)for(var i in n=u.default.createElement("div",{className:"c4g-editor-mode-switcher"},u.default.createElement("button",{title:this.props.lang.EDITOR_FEATURE_DELETE,className:"c4g-editor-feature-delete "+("remove"===this.state.selectMode?"c4g-active":"c4g-inactive"),onMouseUp:function(){e.removeActiveFeature()}})),this.props.editorVars)if(this.props.editorVars.hasOwnProperty(i)){var l=this.props.editorVars[i];if(l.caption&&l.key){var c=this.state.selectedFeature.get(l.key)?this.state.selectedFeature.get(l.key):"";s.push(u.default.createElement("form",{className:"c4g-editor-vars-input",key:i,onSubmit:function(e){e.preventDefault()}},u.default.createElement("label",null,l.caption,":",u.default.createElement("input",{type:"text",value:c,name:l.key,onChange:function(t){e.handleVarChange(t)}}))))}}return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",null,n,u.default.createElement("div",{className:"c4g-editor-element-selection"},a)),u.default.createElement("div",{className:"c4g-editor-vars"},s))}},{key:"resetInteraction",value:function(){this.interaction&&(Array.isArray(this.interaction)?(this.props.mapController.map.removeInteraction(this.interaction[0]),this.props.mapController.map.removeInteraction(this.interaction[1])):this.props.mapController.map.removeInteraction(this.interaction))}},{key:"removeActiveFeature",value:function(){var e=(new p.GeoJSON).writeFeatureObject(this.state.selectedFeature,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});this.props.removeFeature(e),this.props.editorLayer.getSource().removeFeature(this.state.selectedFeature),this.setState({selectedFeature:!1})}},{key:"componentDidUpdate",value:function(e,t,r){var a=this;this.props.elements[0]&&e.mode!==this.props.mode&&(0===this.state.activeElement?this.setState({activeElement:this.props.elements[0].id,activeStyle:this.props.elements[0].styleId}):this.props.elements.find(function(e){return e.id===a.state.activeElement})||this.setState({activeElement:this.props.elements[0].id,activeStyle:this.props.elements[0].styleId}))}},{key:"changeSelectMode",value:function(e){this.setState({selectMode:e})}},{key:"handleVarChange",value:function(e){var t=e.target.value,r=e.target.name;this.state.selectedFeature.set(r,t);var a=(new p.GeoJSON).writeFeatureObject(this.state.selectedFeature,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});this.props.modifyFeature(a),this.setState({selectedFeature:this.state.selectedFeature})}},{key:"changeFreehand",value:function(){this.setState({freehand:!this.state.freehand})}},{key:"changeJSON",value:function(e){this.setState({features:e.target.value})}}])}(u.Component)},45451(e,t,r){var a=r(29138),n=r(35578);Object.defineProperty(t,"__esModule",{value:!0}),t.C4gStarboardStyle=void 0;var o=a(r(1367)),s=a(r(60163)),i=a(r(55956)),l=a(r(20880)),c=a(r(39959)),u=function(e,t){if("function"==typeof WeakMap)var r=new WeakMap,a=new WeakMap;return function(e,t){if(!t&&e&&e.__esModule)return e;var o,s,i={__proto__:null,default:e};if(null===e||"object"!=n(e)&&"function"!=typeof e)return i;if(o=t?a:r){if(o.has(e))return o.get(e);o.set(e,i)}for(var l in e)"default"!==l&&{}.hasOwnProperty.call(e,l)&&((s=(o=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,l))&&(s.get||s.set)?o(i,l,s):i[l]=e[l]);return i}(e,t)}(r(42028)),p=a(r(25089)),d=r(8007),f=r(75508),h=r(46363);function m(e,t,r){return t=(0,l.default)(t),(0,i.default)(e,y()?Reflect.construct(t,r||[],(0,l.default)(e).constructor):t.apply(e,r))}function y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(y=function(){return!!e})()}t.C4gStarboardStyle=function(e){function t(e){return(0,o.default)(this,t),m(this,t,[e])}return(0,c.default)(t,e),(0,s.default)(t,[{key:"enterEvent",value:function(e){13===e.which&&this.props.clickEvent(e)}},{key:"render",value:function(){var e=this,t=null,r=this.props.styleData.arrLocStyles[this.props.styleId],a=r.locStyleArr,n=r.style&&r.style(new p.default({geometry:new d.Point(0,0)}),"EPSG:4326")?r.style(new p.default({geometry:new d.Point(0,0)}),"EPSG:4326"):null,o=Array.isArray(n)?n[0]:n,s=a?a.styletype:"default",i=this.props.tooltip||"";if(!a||"cust_icon"!==s&&"cust_icon_svg"!==s&&"photo"!==s){var l,c,m;switch(s){case"point":l=f.cssConstants.STARBOARD_LOCSTYLE_POINT;break;case"square":l=f.cssConstants.STARBOARD_LOCSTYLE_SQUARE;break;case"star":l=f.cssConstants.STARBOARD_LOCSTYLE_STAR;break;case"x":l=f.cssConstants.STARBOARD_LOCSTYLE_X;break;case"cross":l=f.cssConstants.STARBOARD_LOCSTYLE_CROSS;break;case"triangle":l=f.cssConstants.STARBOARD_LOCSTYLE_TRIANGLE;break;default:l=f.cssConstants.STARBOARD_LOCSTYLE}o&&o.getFill()&&o.getStroke()?(c=o.getFill().getColor(),m=o.getStroke().getColor()):a&&a.fillcolor&&a.strokecolor&&(c=h.utils.getRgbaFromHexAndOpacity(a.fillcolor[0],a.fillcolor[1]),m=h.utils.getRgbaFromHexAndOpacity(a.strokecolor[0],a.strokecolor[1]));var y={"--var-color":c,"--var-bordercolor":m};t=this.props.clickEvent?u.default.createElement("span",{className:l,style:y,title:i,onMouseUp:function(t){return e.props.clickEvent(t)}}):u.default.createElement("span",{className:l,style:y,title:i})}else{var v,g=null;if(a.icon_src&&-1!==a.icon_src.indexOf(".")||a.svgSrc&&-1!==a.svgSrc.indexOf("."))v="cust_icon"===s||"photo"===s?a.icon_src:a.svgSrc,g=u.default.createElement("img",{src:v,style:{height:25,width:25}});else if(o){var S=o.getImage&&"function"==typeof o.getImage&&o.getImage()?o.getImage():null;if(!S||!S.getSrc())return null;g=u.default.createElement("img",{src:S.getSrc(),style:{height:25,width:25}})}t=this.props.clickEvent?u.default.createElement("span",{tabIndex:1,className:f.cssConstants.STARBOARD_LOCSTYLE,title:i,onKeyPress:function(t){return e.enterEvent(t)},onMouseUp:function(t){return e.props.clickEvent(t)}},g):u.default.createElement("span",{className:f.cssConstants.STARBOARD_LOCSTYLE,title:i},g)}return t}}])}(u.Component)}}]);